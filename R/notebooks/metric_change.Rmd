---
title: "Changes"
author: "Jens Laufer"
date: "18 11 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, message = F, warning = F)
```

```{r}
library(bbplot)
```


```{r}
source("../apps/api.R")
windowsFonts(Helvetica = "TT Arial")
```

```{r}
data <- load.data()
```



```{r}
data %>%
        filter(`Date` == max(`Date`),!is.na(ParentCategory)) %>% 
        cluster.data()
```


```{r}
data %>% filter(Id == '007XHTML') %>% 
  select(Id, Date, Gravity, Gravity_Change)
```


```{r fig.height=10, fig.width=20}
data %>% 
  #filter(Id == '0NOTHING0') %>% 
  select(Id, Title, ParentCategory, Category, Date, Gravity, Gravity_Change) %>% 
  filter(Gravity_Change != Inf) %>% 
  distinct(Id, .keep_all = T) %>% 
  arrange(-Gravity_Change) %>% 
  head(20) %>% 
  ggplot() +
  geom_bar(aes(x=reorder(paste(Id, Title, sep = ': '), Gravity_Change), y=Gravity_Change), stat = 'identity') +
  coord_flip() +
  bbc_style()
  
```



