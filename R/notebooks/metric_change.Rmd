---
title: "Changes"
author: "Jens Laufer"
date: "18 11 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, message = F, warning = F)
```


```{r}
source("../apps/api.R")
```


```{r}
data <- load.data() %>% 
    mutate_at(c('Id', 'ParentCategory', 'Category'), ~ as.factor(.)) %>%
    arrange(Id, ParentCategory, Category, Date)  %>%
    group_by(Id, ParentCategory, Category) %>% 
    mutate_at(numeric.cols, list(Change = ~ ((.) - dplyr::lag(.)) / dplyr::lag(.))) %>% 
    ungroup()
```

```{r}
data %>% 
  #filter(Id == '0NOTHING0') %>% 
  select(Id, ParentCategory, Category, Date, Gravity, Gravity_Change) %>% 
  filter(Gravity_Change != Inf) %>% 
  arrange(-Gravity_Change)
  
```



